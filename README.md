# Effective_mobile_backend

# Описание проекта

Проект состоит из трёх микросервисов, разработанных для управления данными о товарах, пользователях и их действиях. Каждый микросервис имеет свой набор функциональных возможностей и доступен по отдельным эндпоинтам.

# Сервисы

## Сервис управления остатками товаров

Отвечает за создание, управление, и фильтрацию данных о товарах и их остатках в магазинах.
Сервис истории действий с товарами

Сохраняет и предоставляет доступ к записям о действиях, совершённых с товарами или их остатками.
Сервис управления пользователями

Предназначен для управления информацией о пользователях, включая массовое обновление их данных.
Запуск проекта
Шаги для локального запуска
Установите зависимости:

```bash
npm install
```

### Настройте файл .env для каждого сервиса, указав(вообще по идее и без них должно работать в docker-compose.yml все есть):

NODE_ENV=development
LOG_LEVEL=debug
PORT=PORT
DATABASE_URL
Запустите сервисы:

```bash
docker-compose up --build
```

Эндпоинты

## 1. Сервис управления остатками товаров

Базовый URL: http://localhost:5004/api/v1

### Эндпоинты

POST /products — Создание товара

POST /stocks — Создание остатка

PATCH /stocks/increase — Увеличение остатка

PATCH /stocks/decrease — Уменьшение остатка

GET /stocks — Получение остатков по фильтрам (параметры: plu, shop_id, quantity_on_shelf, quantity_in_order)

GET /products — Получение товаров по фильтрам (параметры: name, plu)

Swagger документация: http://localhost:5004/api-docs

## 2. Сервис истории действий с товарами

Базовый URL: http://localhost:5005/api/v1

### Эндпоинты

GET /actions — Получение истории действий с фильтрами

Фильтры: shop_id, plu, date (с-по), action

Постраничная навигация: поддерживается

Swagger документация: http://localhost:5005/api-docs

## 3. Сервис управления пользователями

Базовый URL: http://localhost:5003

### Эндпоинты

PUT /users/resolve-issues — Проставляет флаг проблемы у пользователей в false и возвращает количество пользователей, у которых был true.
Swagger документация: http://localhost:5003/api-docs

# Архитектура микросервисов

## Сервис управления остатками товаров (порт 5004)

Реализован на TypeScript.
Взаимодействует с базой данных PostgreSQL.
Работает с нормализованной схемой данных для товаров и остатков.

## Сервис истории действий с товарами (порт 5005)

Реализован на JavaScript.
Получает события от сервиса товаров (через RabbitMQ).
Хранит записи в PostgreSQL и поддерживает фильтрацию и пагинацию.

## Сервис управления пользователями (порт 5003)

Реализован на NestJS.
Ориентирован на высокую производительность при работе с большим количеством данных (более 1 миллиона пользователей).
Поддерживает массовое обновление данных.

# Прод сервер

Сервер доступен по ip 212.193.31.229,

nginx проксирует на 80 порту

stock_control/api-docs (докуметация сваггер для stock_control)

actions/api-docs (документация сваггер для action_history)

users/api-docs (докуметация сваггер для users)

Взаимодействовать с сервисами через документацию не получится из-за CORS, но через Postman должно работать.
